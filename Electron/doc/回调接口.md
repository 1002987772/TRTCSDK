
TRTCCloudCallback @ TXLiteAVSDK。

__功能__

腾讯云视频通话功能的回调接口类。



## 通用事件回调
### onError

错误回调：SDK 不可恢复的错误，一定要监听，并分情况给用户适当的界面提示。
```
onError(errCode, errMsg, extraInfo)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| errCode | int | 错误码。 |
| errMsg | String | 错误信息。 |


### onWarning

警告回调：用于告知您一些非严重性问题，例如出现了卡顿或者可恢复的解码失败。
```
void onWarning(warningCode, warningMsg)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| warningCode | int | 警告码。 |
| warningMsg | String | 警告信息。 |




## 房间事件回调
### onEnterRoom

已加入房间的回调。
```
onEnterRoom(result)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| result | int | result > 0 时为进房耗时（ms），result < 0 时为进房错误码。 |

__介绍__

调用 TRTCCloud 中的 enterRoom() 接口执行进房操作后，会收到来自 SDK 的 onEnterRoom(result) 回调：
- 如果加入成功，result 会是一个正数（result > 0），表示加入房间所消耗的时间，单位为毫秒（ms）。
- 如果加入失败，result 会是一个负数（result < 0），表示进房失败的错误码。进房失败的错误码含义请参见 [错误码](https://cloud.tencent.com/document/product/647/32257)。

>?在 Ver6.6 之前的版本，只有进房成功会抛出 onEnterRoom(result) 回调，进房失败由 [onError()](https://cloud.tencent.com/document/product/647/32270#onerror) 回调抛出。 在 Ver6.6 及之后改为：进房成功返回正的 result，进房失败返回负的 result，同时进房失败也会有 [onError()](https://cloud.tencent.com/document/product/647/32270#onerror) 回调抛出。



### onExitRoom

离开房间的事件回调。
```
onExitRoom(reason)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| reason | int | 离开房间原因，0：主动调用 exitRoom 退房；1：被服务器踢出当前房间；2：当前房间整个被解散。 |

__介绍__

调用 TRTCCloud 中的 exitRoom() 接口会执行退出房间的相关逻辑，例如释放音视频设备资源和编解码器资源等。 待资源释放完毕，SDK 会通过 [onExitRoom()] 回调通知到您。
如果您要再次调用 enterRoom() 或者切换到其他的音视频 SDK，请等待 [onExitRoom()] 回调到来后再执行相关操作。否则可能会遇到例如摄像头、麦克风设备被强占等各种异常问题。


### onSwitchRole

切换角色的事件回调。
```
onSwitchRole(errCode, errMsg)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| errCode | int | 错误码，ERR_NULL 代表切换成功，其他请查阅[错误码表](https://cloud.tencent.com/document/product/647/32257)。 |
| errMsg | String | 错误信息。 |

__介绍__

调用 TRTCCloud 中的 switchRole() 接口会切换主播和观众的角色，该操作会伴随一个线路切换的过程， 待 SDK 切换完成后，会抛出 [onSwitchRole()] 事件回调。


### onConnectOtherRoom

请求跨房通话（主播 PK）的结果回调。
```
onConnectOtherRoom(userId, errCode, errMsg)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 要 PK 的目标主播 userId。 |
| errCode | int | 错误码，ERR_NULL 代表切换成功，其他请查阅[错误码表](https://cloud.tencent.com/document/product/647/32257)。 |
| errMsg | String | 错误信息。 |

__介绍__

调用 TRTCCloud 中的 connectOtherRoom() 接口会将两个不同房间中的主播拉通视频通话，也就是所谓的“主播PK”功能。 调用者会收到 [onConnectOtherRoom()]回调来获知跨房通话是否成功， 如果成功，两个房间中的所有用户都会收到 PK 主播的 [onUserVideoAvailable()] 回调。


### onDisconnectOtherRoom

结束跨房通话（主播 PK）的结果回调。
```
onDisconnectOtherRoom(errCode, errMsg)
```


## 成员事件回调
### onUserEnter

有用户（主播）加入当前房间。
```
onUserEnter(userId)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |

__介绍__

没有开启音视频上行的观众在加入房间时不会触发该通知，只有开启音视频上行的主播加入房间时才会触发该通知。通知参数中 userId 对应的用户一定已开启声音上行，但不一定已开启视频。
如果需要显示远程画面，更推荐监听 [onUserVideoAvailable()] 事件回调。


### onUserExit

有用户（主播）离开当前房间。
```
onUserExit(userId, reason)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| reason | int | 离开原因代码，区分用户是正常离开，还是由于网络断线等原因离开。 |


### onUserVideoAvailable

用户是否开启摄像头视频。
```
onUserVideoAvailable(userId, available)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| available | bool | 画面是否开启。 |

__介绍__

当您收到 onUserVideoAvailable(userId， YES) 通知时，代表该路画面已经有可用的视频数据帧到达。此时，您需要调用 startRemoteView(userId) 接口加载该用户的远程画面。然后，您还会收到名为 onFirstVideoFrame(userId) 的首帧画面渲染回调。
当您收到 onUserVideoAvailable(userId， NO) 通知时，代表该路远程画面已经被关闭，可能由于该用户调用了 muteLocalVideo() 或 stopLocalPreview()。

### onUserSubStreamAvailable

用户是否开启屏幕分享。
```
onUserSubStreamAvailable(userId, available)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| available | bool | 屏幕分享是否开启。 |

>?显示辅路画面使用的函数不是 startRemoteView() 而是 startRemoteSubStreamView()。



### onUserAudioAvailable

用户是否开启音频上行。
```
onUserAudioAvailable(userId, available)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| available | bool | 声音是否开启。 |


### onFirstVideoFrame

开始渲染本地或远程用户的首帧画面。
```
onFirstVideoFrame(userId, streamType, width, height)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 本地或远程用户 ID，如果 userId == null 代表本地，userId != null 代表远程。 |
| streamType | int | 视频流类型：摄像头或屏幕分享。 |
| width |  int | 画面宽度。 |
| height |  int | 画面高度。 |

__介绍__

如果 userId 为 null，表示开始渲染本地采集的摄像头画面，需要您先调用 startLocalPreview 触发。 如果 userId 不为 null，表示开始渲染远程用户的首帧画面，需要您先调用 startRemoteView 触发。

>?只有当您调用 startLocalPreview()、startRemoteView() 或 startRemoteSubStreamView() 之后，才会触发该回调。



### onFirstAudioFrame

开始播放远程用户的首帧音频（本地声音暂不通知）。
```
onFirstAudioFrame(userId)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 远程用户 ID。 |


### onSendFirstLocalVideoFrame

首帧本地视频数据已经被送出。
```
onSendFirstLocalVideoFrame(streamType)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| streamType | int | 视频流类型，主画面、小画面或辅流画面（屏幕分享）。 |

__介绍__

SDK 会在 enterRoom() 并 startLocalPreview() 成功后开始摄像头采集，并将采集到的画面进行编码。 当 SDK 成功向云端送出第一帧视频数据后，会抛出这个回调事件。


### onSendFirstLocalAudioFrame

首帧本地音频数据已经被送出。
```
onSendFirstLocalAudioFrame()
```

__介绍__

SDK 会在 enterRoom() 并 startLocalAudio() 成功后开始麦克风采集，并将采集到的声音进行编码。 当 SDK 成功向云端送出第一帧音频数据后，会抛出这个回调事件。



## 统计和质量回调
### onNetworkQuality

网络质量：该回调每2秒触发一次，统计当前网络的上行和下行质量。
```
onNetworkQuality(localQuality, remoteQuality)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| localQuality | [TRTCQualityInfo] | 上行网络质量。 |
| remoteQuality | [TRTCQualityInfo] | 下行网络质量。 |


>?userId == null 代表自己当前的视频质量。


### onStatistics

技术指标统计回调。
```
onStatistics(statis)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| statis | [TRTCStatistics] | 统计数据，包括本地和远程的。 |

__介绍__

如果您是熟悉音视频领域相关术语，可以通过这个回调获取 SDK 的所有技术指标。 如果您是首次开发音视频相关项目，可以只关注 onNetworkQuality 回调。

>?每2秒回调一次。



## 服务器事件回调
### onConnectionLost

SDK 跟服务器的连接断开。
```
onConnectionLost()
```


### onTryToReconnect

SDK 尝试重新连接到服务器。
```
onTryToReconnect()
```


### onConnectionRecovery

SDK 跟服务器的连接恢复。
```
onConnectionRecovery()
```


### onSpeedTest

服务器测速的回调，SDK 对多个服务器 IP 做测速，每个 IP 的测速结果通过这个回调通知。
```
onSpeedTest(currentResult, finishedCount, totalCount)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| currentResult |  [TRTCSpeedTestResult] | 当前完成的测速结果。 |
| finishedCount | int | 已完成测速的服务器数量。 |
| totalCount | int | 需要测速的服务器总数量。 |



## 硬件设备事件回调
### onCameraDidReady

摄像头准备就绪。
```
onCameraDidReady()
```


### onMicDidReady

麦克风准备就绪。
```
onMicDidReady()
```


### onUserVoiceVolume

用于提示音量大小的回调，包括每个 userId 的音量和远端总音量。
```
onUserVoiceVolume(userVolumes, userVolumesCount, totalVolume)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userVolumes | [TRTCVolumeInfo]  | 所有正在说话的房间成员的音量，取值范围0 - 100。 |
| userVolumesCount | int | 房间成员数量。 |
| totalVolume | int | 所有远端成员的总音量, 取值范围0 - 100。 |

__介绍__

您可以通过调用 TRTCCloud 中的 enableAudioVolumeEvaluation 接口来开关这个回调或者设置它的触发间隔。调用 enableAudioVolumeEvaluation 开启音量回调后，无论频道内是否有人说话，都会按设置的时间间隔调用这个回调，如果没有人说话，则 userVolumes 为空，totalVolume 为0。

>?userId 为 null 时表示自己的音量，userVolumes 内仅包含正在说话（音量不为0）的用户音量信息。



### onDeviceChange

本地设备通断回调。
```
void onDeviceChange(deviceId, type, state)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| deviceId | String | 设备 ID。 |
| type | [TRTCDeviceType]| 设备类型。 |
| state | [TRTCDeviceState]| 事件类型。 |


### onTestMicVolume

麦克风测试音量回调。
```
onTestMicVolume(volume)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| volume | int | 音量值，取值范围0 - 100。 |

__介绍__

麦克风测试接口 startMicDeviceTest 会触发这个回调。


### onTestSpeakerVolume

扬声器测试音量回调。
```
onTestSpeakerVolume(volume)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| volume | int | 音量值，取值范围0 - 100。 |

__介绍__

扬声器测试接口 startSpeakerDeviceTest 会触发这个回调。



## 自定义消息的接收回调
### onRecvCustomCmdMsg

收到自定义消息回调。
```
onRecvCustomCmdMsg(userId, cmdID, seq, message, messageSize)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| cmdID | int | 命令 ID。 |
| seq | int | 消息序号。 |
| message | String | 消息数据。 |
| messageSize | int | 消息数据大小。 |

__介绍__

当房间中的某个用户使用 sendCustomCmdMsg 发送自定义消息时，房间中的其它用户可以通过 onRecvCustomCmdMsg 接口接收消息。


### onMissCustomCmdMsg

自定义消息丢失回调。
```
onMissCustomCmdMsg(userId, cmdID, errCode, missed)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| cmdID | int | 命令 ID。 |
| errCode | int | 错误码。 |
| missed | int | 丢失的消息数量。 |

__介绍__

实时音视频使用 UDP 通道，即使设置了可靠传输（reliable）也无法确保100%不丢失，只是丢消息概率极低，能满足常规可靠性要求。在发送端设置了可靠传输（reliable）后，SDK 都会通过此回调通知过去时间段内（通常为5s）传输途中丢失的自定义消息数量统计信息。


>?只有在发送端设置了可靠传输（reliable），接收方才能收到消息的丢失回调。


### onRecvSEIMsg

收到 SEI 消息的回调。
```
onRecvSEIMsg(userId, message, messageSize)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| userId | String | 用户标识。 |
| message | String | 数据。 |
| messageSize | int | 数据大小。 |

__介绍__

当房间中的某个用户使用 sendSEIMsg 发送数据时，房间中的其它用户可以通过 onRecvSEIMsg 接口接收数据。



## CDN 旁路转推回调
### onStartPublishCDNStream

启动旁路推流到 CDN 完成的回调。
```
onStartPublishCDNStream(errCode, errMsg)
```

__介绍__

对应于 TRTCCloud 中的 startPublishCDNStream() 接口。

>?Start 回调如果成功，只能说明转推请求已经成功告知给腾讯云，如果目标 CDN 有异常，还是有可能会转推失败。



### onStopPublishCDNStream

停止旁路推流到 CDN 完成的回调。
```
onStopPublishCDNStream(errCode, errMsg)
```

__介绍__

对应于 TRTCCloud 中的 stopPublishCDNStream() 接口。


### onSetMixTranscodingConfig

设置云端的混流转码参数的回调，对应于 TRTCCloud 中的 setMixTranscodingConfig() 接口。
```
onSetMixTranscodingConfig(errCode, errMsg)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| errCode | int | 0表示成功，其余值表示失败。 |
| errMsg | String | 具体错误原因。 |



## 屏幕分享回调
### onScreenCaptureCovered

当屏幕分享窗口被遮挡无法正常捕获时，SDK 会通过此回调通知，可在此回调里通知用户移开遮挡窗口。
```
onScreenCaptureCovered()
```


### onScreenCaptureStarted

当屏幕分享开始时，SDK 会通过此回调通知。
```
onScreenCaptureStarted()
```


### onScreenCapturePaused

当屏幕分享暂停时，SDK 会通过此回调通知。
```
onScreenCapturePaused(reason)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| reason | int | 停止原因，0：表示用户主动暂停；1：表示设置屏幕分享参数导致的暂停；2：表示屏幕分享窗口被最小化导致的暂停；3：表示屏幕分享窗口被隐藏导致的暂停。 |


### onScreenCaptureResumed

当屏幕分享恢复时，SDK 会通过此回调通知。
```
onScreenCaptureResumed(reason)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| reason | int | 停止原因，0：表示用户主动恢复，1：表示屏幕分享参数设置完毕后自动恢复；2：表示屏幕分享窗口从最小化被恢复；3：表示屏幕分享窗口从隐藏被恢复。 |


### onScreenCaptureStoped

当屏幕分享停止时，SDK 会通过此回调通知。
```
onScreenCaptureStoped(reason)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| reason | int | 停止原因，0：表示用户主动停止；1：表示屏幕分享窗口被关闭。 |



## 背景混音事件回调
### onPlayBGMBegin

开始播放背景音乐。
```
onPlayBGMBegin(errCode)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| errCode | int | 错误码。 |


### onPlayBGMProgress

播放背景音乐的进度。
```
onPlayBGMProgress(progressMS, durationMS)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| progressMS | int | 已播放时间。 |
| durationMS | int | 总时间。 |


### onPlayBGMComplete

播放背景音乐结束。
```
onPlayBGMComplete(errCode)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| errCode | int | 错误码。 |


## 日志回调

__功能__

日志相关回调。



### onLog

有日志打印时的回调。
```
void onLog(log, level, module)
```

__参数__

| 参数 | 类型 | 含义 |
|-----|-----|-----|
| log | String | 日志内容。 |
| level | [TRTCLogLevel] | 日志等级 参见 TRTCLogLevel。 |
| module | String | 暂无具体意义，目前为固定值 TXLiteAVSDK。 |



